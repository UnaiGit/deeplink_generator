@if (isOpen()) {
  <div class="departments-overlay">
    <div class="departments-modal" (click)="$event.stopPropagation()">
      <!-- Header -->
      <div class="departments-header">
        <h2 class="departments-title">Departments</h2>
        <button class="close-button" (click)="onClose()" aria-label="Close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <!-- Content -->
      <div class="departments-content">
        @for (dept of departments; track dept.id) {
          <div class="department-item"
               [class.selected]="selectedDepartment()?.id === dept.id"
               [draggable]="true"
               (dragstart)="onDragStart($event, dept)"
               (dragend)="onDragEnd($event)">
            <div class="department-icon">
              <img [src]="dept.icon" [alt]="dept.name" class="icon-image" />
            </div>
            <div class="department-info">
              <h3 class="department-name">{{ dept.name }}</h3>
              <p class="department-description">{{ dept.description }}</p>
            </div>
            <button class="department-menu" aria-label="More options">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="5" r="1"></circle>
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="12" cy="19" r="1"></circle>
              </svg>
            </button>
          </div>
        }
      </div>

      <!-- Footer -->
      <div class="departments-footer">
        <button class="cancel-button" (click)="onClose()">Cancel</button>
        <button class="save-button" (click)="onSave()">Save</button>
      </div>
    </div>
  </div>
}

