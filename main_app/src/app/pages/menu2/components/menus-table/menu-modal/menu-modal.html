<div class="modal-backdrop" *ngIf="isOpen">
  <!-- Delete Confirmation Modal (Centered) -->
  <div
    *ngIf="isDeleteMode()"
    class="delete-modal-container"
    [class.open]="isOpen && isDeleteMode()"
    (click)="$event.stopPropagation()"
  >
    <div class="delete-modal-content">
      <h3 class="delete-title">{{ 'Delete Menu' | translate }}?</h3>
      <p class="delete-message">
        {{ 'Are you sure you want to delete' | translate }} "<strong>{{ data?.category }}</strong>"?
        {{ 'This action cannot be undone' | translate }}.
      </p>
      <div class="delete-actions">
        <button class="cancel-button" type="button" (click)="onClose()">{{ 'Cancel' | translate }}</button>
        <button class="delete-confirm-button" type="button" (click)="onDelete()">{{ 'Delete' | translate }}</button>
      </div>
    </div>
  </div>

  <!-- Create/Edit Menu Modal (Side Panel) -->
  <div
    *ngIf="!isDeleteMode()"
    class="modal-container"
    [class.open]="isOpen"
    (click)="$event.stopPropagation()"
  >
    <!-- Header -->
    <div class="modal-header">
      <h2 class="modal-title">{{ getTitle() | translate }}</h2>
      <button class="close-button" type="button" (click)="onClose()">×</button>
    </div>

    <!-- Content -->
    <div class="modal-content">
      <!-- Category -->
      <div class="form-group">
        <label class="form-label">{{ 'Category' | translate }}</label>
        <div class="input-wrapper">
          <div class="input-icon">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M3 3h10M3 8h10M3 13h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </div>
          <select class="form-input" [(ngModel)]="formData.category">
            <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
          </select>
          <div class="dropdown-arrow">▼</div>
        </div>
      </div>

      <!-- Price -->
      <div class="form-group">
        <label class="form-label">{{ 'Price (in €)' | translate }}</label>
        <div class="input-wrapper">
          <div class="input-icon currency-icon">
            <span>€</span>
          </div>
          <input
            type="number"
            class="form-input"
            placeholder="€8"
            [(ngModel)]="formData.price"
          />
        </div>
      </div>

      <!-- Availability -->
      <div class="form-group availability-section">
        <label class="form-label">{{ 'Availability' | translate }}</label>
        
        <!-- Days -->
        <div class="days-section">
          <label class="section-label">{{ 'Days' | translate }}</label>
          <div class="days-buttons">
            <button
              *ngFor="let day of days"
              type="button"
              class="day-button"
              [class.selected]="isDaySelected(day)"
              (click)="toggleDay(day)"
            >
              {{ day | translate }}
            </button>
          </div>
        </div>

        <!-- Time Range Inputs -->
        <div class="time-range">
          <div class="time-field">
            <label class="section-label">{{ 'From' | translate }}</label>
            <div class="input-wrapper" (click)="openTimePicker('from')">
              <div class="input-icon">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M8 5v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </div>
              <input
                type="text"
                class="form-input time-input"
                [value]="formData.availability.from"
                placeholder="09:30"
                readonly
              />
              <div class="dropdown-arrow">▼</div>
            </div>
          </div>

          <div class="time-field">
            <label class="section-label">{{ 'Until' | translate }}</label>
            <div class="input-wrapper" (click)="openTimePicker('until')">
              <div class="input-icon">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M8 5v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </div>
              <input
                type="text"
                class="form-input time-input"
                [value]="formData.availability.until"
                placeholder="21:00"
                readonly
              />
              <div class="dropdown-arrow">▼</div>
            </div>
          </div>
        </div>

        <!-- Circular Time Picker -->
        <div *ngIf="showTimePicker" class="time-picker-container" (click)="$event.stopPropagation()">
          <div class="time-picker-header">
            <span class="time-picker-label">{{ (timePickerMode === 'from' ? 'From' : 'Until') | translate }}</span>
            <button class="time-picker-close" type="button" (click)="closeTimePicker()">×</button>
          </div>
          <div class="time-picker-clock">
            <svg viewBox="-150 -150 300 300" class="clock-svg">
              <!-- Hour Numbers -->
              <g *ngFor="let hour of hours">
                <circle 
                  [attr.cx]="getHourPosition(hour).x" 
                  [attr.cy]="getHourPosition(hour).y"
                  [attr.r]="hour === selectedHour ? 18 : 0"
                  [attr.fill]="hour === selectedHour ? '#4285F4' : 'transparent'"
                  class="hour-circle"
                  (click)="selectHour(hour)"
                />
                <text 
                  [attr.x]="getHourPosition(hour).x" 
                  [attr.y]="getHourPosition(hour).y"
                  class="hour-label"
                  [class.selected]="hour === selectedHour"
                  (click)="selectHour(hour)"
                >
                  {{ hour }}
                </text>
              </g>
              
              <!-- Clock Hand -->
              <line 
                x1="0" 
                y1="0" 
                [attr.x2]="getHandEndPosition().x" 
                [attr.y2]="getHandEndPosition().y"
                stroke="#4285F4" 
                stroke-width="2" 
                stroke-linecap="round"
                class="clock-hand"
              />
              
              <!-- Center Dot -->
              <circle cx="0" cy="0" r="4" fill="#4285F4" class="center-dot"/>
            </svg>
          </div>
        </div>
      </div>

      <!-- Dishes -->
      <div class="form-group dishes-section">
        <label class="form-label">{{ 'Dishes' | translate }}</label>
        
        <div *ngFor="let dish of formData.dishes; let i = index" class="dish-row">
          <div class="dish-input-group">
            <div class="dish-field">
              <label class="section-label">{{ 'Dish' | translate }}</label>
              <div class="input-wrapper">
                <div class="input-icon">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <circle cx="7" cy="7" r="5" stroke="currentColor" stroke-width="1.5" fill="none"/>
                    <path d="M14 14l-3-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                </div>
                <input
                  type="text"
                  class="form-input"
                  placeholder="Prawns"
                  [(ngModel)]="dish.dish"
                />
              </div>
            </div>

            <div class="extra-cost-field">
              <label class="section-label">{{ 'Extra cost' | translate }}</label>
              <div class="input-wrapper">
                <input
                  type="text"
                  class="form-input"
                  placeholder="0..20"
                  [(ngModel)]="dish.extraCost"
                />
              </div>
            </div>

            <button
              *ngIf="i === formData.dishes.length - 1"
              class="add-dish-button"
              type="button"
              (click)="addDish()"
            >
              +
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="save-button" type="button" (click)="onSave()">
        {{ getButtonText() | translate }}
      </button>
    </div>
  </div>
</div>

